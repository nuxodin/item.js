<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Test</title>
<body>

<h1>Test</h1>

<script type=module>

import {IDB} from "../drivers/indexedDb.js";

const idb = IDB();

const store = idb.item('keyval-store');
store.open(2, {
    upgrade(db, oldVersion, newVersion, transaction) {
        if (oldVersion < 1) {
            db.createObjectStore('keyval');
        }
    }
});

store.item('keyval').item('item1').value = 'value1';
store.item('keyval').item('item2').value = {a:1, b:2}; // add value as object
store.item('keyval').value = {item3: 'value3', item4: 'value4'}; // add multiple items


const valItem2 = await store.item('keyval').item('item2').value;



// proxy test


let test = idb.item('testx');
test.open(11, {
    upgrade(db, oldVersion, newVersion, transaction) {
        const stores = new Set(db.objectStoreNames);
        !stores.has('user') && db.createObjectStore('user');
        !stores.has('group') && db.createObjectStore('group');
        !stores.has('post') && db.createObjectStore('post');
    }
});

import {proxy} from "../item.js";

test = proxy(test);
test.user.hans = 'value1';
test.user.urs = 'value1';
test.user.sepp = 'value1';


</script>
