<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Test</title>
    <script type="module" src="../item.js"></script>
<body>

<h1>Test</h1>


<script type=module>


import {item, effect} from "../item.js";
import {syncWith} from "../tools/syncWith.js";
import {dump} from 'https://cdn.jsdelivr.net/gh/nuxodin/dump.js@1.2.2/mod.min.js';


const original = {
    a: 1,
    b: {
        c: 2,
        d: 3,
    },
}
const i = item(original);
syncWith(i, original);

effect(()=>{
    dumpEl.innerHTML = dump(i.value);
    dumpEl.innerHTML += dump(original);
});


i.item('a').value = new Date();
await delay(1000);
i.item('c').value = 8;
await delay(1000);
i.item('b').value = 22;
await delay(1000);
i.item('d').value = {d1: 8, d2: 9};
await delay(1000);
i.item('c').value = 'x';
await delay(1000);
i.item('c').value = {c1: 8, c2: 9};
await delay(1000);






function delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

</script>

<div id=dumpEl></div>