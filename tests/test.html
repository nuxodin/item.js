<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Test</title>
    <script type="module" src="../item.js"></script>
<body>

<h1>Test</h1>


<script type=module>


import {item} from "../item.js";
import {dump} from 'https://cdn.jsdelivr.net/gh/nuxodin/dump.js@1.2.1/mod.min.js';


const v = item(33);

v.addEventListener("setIn", e => {
    console.log("setIn", e.detail);
});

v.value = "test";
v.value = {a:1, b:2};


let i = item();
i.addEventListener('setIn', e => {
    console.log(e.detail.item.key)
});
//i.item('a').value = ;



let obj = {
    a:1,
    b:2,
    b: {
        b1: 1,
        b2: 2,
    },
}

let o = item(obj);

o.addEventListener('setIn', e => {
    setTimeout(() => {
        document.body.innerHTML = dump(o.value, {order:0, inherited:true});
    }, 0);
});

o.item('b').item('b1').value = 3;
setTimeout(() => {
    o.item('b').item('b1').value = Promise.resolve(1);
    console.log(o.item('b').item('b1').value)
}, 1000);



</script>
